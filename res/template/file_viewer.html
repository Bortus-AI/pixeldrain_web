{{define "file_viewer"}}
<!DOCTYPE html>
<html>
	<head>
		<title>{{.Title}}</title>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		{{template "user_style" .}}
		<link rel="stylesheet" href="/res/style/viewer.css?v3"/>
		<link rel="stylesheet" href="/res/style/layout.css?v3"/>
		<link rel="shortcut icon" href="/res/img/tray32.png"/>
		<link rel="icon" sizes="180x180" href="/res/img/pixeldrain.png"/>
		<link rel="icon" sizes="256x256" href="/res/img/pixeldrain_big.png"/>
		<meta name="theme-color" content="#75AD38"/>

		{{template "bgpattern"}}

		{{.OGData}}

		<script type="text/javascript">
			var apiEndpoint = '{{.APIEndpoint}}';
			var captchaKey = '{{.Other.CaptchaKey}}';
		</script>
	</head>

	<body>
		<div id="file_viewer" class="file_viewer">
			<div id="file_viewer_headerbar" class="highlight_headerbar">
				<button id="button_toggle_toolbar" class="button_toggle_toolbar" onClick="Toolbar.toggle();">â˜°</button>
				<a href="/" id="button_home" class="button button_home">
					<img src="/res/img/pixeldrain_transparent.png" alt="Back to the Home page" style="height: 1.5em; margin: -0.3em;"/>
					<!-- Yo -->
				</a>
				<span id="file_viewer_headerbar_title" class="file_viewer_headerbar_title">{{.Title}}</span>
				<div id="list_navigator_buttons" class="list_navigator_buttons"></div>
				<button id="button_close_file_viewer" class="button_close_file_viewer button_red" onClick="window.close();">X</button>
			</div>
			<div id="listNavigator" class="list_navigator">
				<div id="listNavigatorItems"></div>
			</div>
			<div id="file_viewer_window" class="file_viewer_window">
				<div id="toolbar" class="file_viewer_toolbar">
					<!-- Ugly workaround to get rid of the scrollbar in non-webkit browsers -->
					<div>
						<div>
							<div id="stat_views_label" class="toolbar_label">Views</div>
							<div id="stat_views" style="text-align: center;">N/A</div>
							<div id="stat_downloads_label" class="toolbar_label">Downloads</div>
							<div id="stat_downloads" style="text-align: center;">N/A</div>

							<button id="btnDownload" class="toolbar_button button_full_width" onClick="Toolbar.download();">
								<img src="/res/img/floppy_small.png" alt="Download this file"/>
								<span>Download</span>
							</button>
							<button id="btnCopy" class="toolbar_button button_full_width" onClick="Toolbar.copyUrl();">
								<img src="/res/img/clipboard_small.png" alt="Copy file URL to clipboard"/>
								<span>Copy</span>
							</button>
							<button id="btnShare" class="toolbar_button button_full_width" onClick="Sharebar.toggle();">
								<img src="/res/img/share_small.png" alt="Share this file on social media"/>
								<span>Share</span>
							</button>
							<button id="btnDetails" class="toolbar_button button_full_width" onClick="DetailsWindow.toggle();">
								<img src="/res/img/info_small.png" alt="Help"/>
								<span>Details</span>
							</button>
							{{template "advertisement" .}}

							<!-- This frame will load the download URL when a download button is pressed -->
							<iframe id="download_frame" style="display: none; width: 1px; height: 1px;"></iframe>
						</div>
					</div>
				</div>

				<div id="sharebar" class="file_viewer_sharebar">
					Share on:<br/>
					<button class="sharebar-button button_full_width" onClick="window.open('mailto:please@set.address?subject=File%20on%20PixelDrain&body=You%20can%20view%20it%20here%20' + window.location.href);">
						<img src="/res/img/social_email.png" alt="Share on E-Mail" style="width:40px; height: 40px;"/>
						<br/>E-Mail
					</button>
					<button class="sharebar-button button_full_width" onclick="window.open('https://www.reddit.com/submit?url=' + window.location.href);">
						<img src="/res/img/social_reddit.png" alt="Share on Reddit" style="width:40px; height: 40px;"/>
						<br/>Reddit
					</button>
					<button class="sharebar-button button_full_width" onClick="window.open('https://twitter.com/share?text=Check%20out%20this%20file%20on%20%23Pixeldrain&url=' + window.location.href);">
						<img src="/res/img/social_twitter.png" alt="Share on Twitter" style="width:40px; height: 40px;"/>
						<br/>Twitter
					</button>
					<button class="sharebar-button button_full_width" onClick="window.open('http://www.facebook.com/sharer.php?u=' + window.location.href);">
						<img src="/res/img/social_facebook.png" alt="Share on Facebook" style="width:40px; height: 40px;"/>
						<br/>Facebook
					</button>
					<button class="sharebar-button button_full_width" onClick="window.open('http://www.tumblr.com/share/link?url=' + window.location.href);">
						<img src="/res/img/social_tumblr.png" alt="Share on Tumblr" style="width:40px; height: 40px;"/>
						<br/>Tumblr
					</button>
					<button class="sharebar-button button_full_width" onClick="window.open('https://voat.co/submit?linkpost=true&url=' + window.location.href);">
						<img src="/res/img/social_voat.png" alt="Share on Voat" style="width:40px; height: 40px;"/>
						<br/>Voat
					</button>
				</div>

				<div id="filepreview" class="file_viewer_file_preview">
					<img src="/res/img/misc/loadthink.gif" style="margin-top: 20%; width: 200px; height: 200px;" />
				</div>
			</div>
		</div>

		<div id="details_popup" class="popup details_popup">
			<div id="details_popup_title" class="highlight_headerbar">
				File Info
				<button style="position: absolute; top: 3px; right: 3px;" class="button_red" onclick="DetailsWindow.toggle();">X</button>
			</div>
			<div class="content_area">
				<span id="info_file_details"></span>
				<span id="info_about">
					<h3>Downloads and views</h3>
					<div id="chart_container" class="chart-container" style="position: relative; width: 100%; height: auto;">
						<canvas id="bandwidth_chart"></canvas>
					</div>
					<p style="text-align: center">
						Chart rendered by the amazing <a href="https://www.chartjs.org/" target="_blank">Chart.js</a>.
					</p>

					<h3>About</h3>
					Pixeldrain is a file sharing platform.
					<a href="/" target="_blank">Visit the home page for more information.</a>

					<h3>Keyboard Controls</h3>
					<table>
						<tr><td colspan="2">File Shortcuts</td></tr>
						<tr><td>c</td><td> = Copy URL of this page</td></tr>
						<tr><td>i</td><td> = Toggle details window (this window) (<b><u>i</u></b>nfo)</td></tr>
						<tr><td>s</td><td> = Download the file you are currently viewing (<b><u>s</u></b>ave)</td></tr>
						<tr><td>q</td><td> = Close the window (<b><u>q</u></b>uit)</td></tr>
						<tr><td colspan="2">List Shortcuts</td></tr>
						<tr><td>a or &#8592;</td><td> = View previous item in list</td></tr>
						<tr><td>d or &#8594;</td><td> = View next item in list</td></tr>
						<tr><td>r</td><td> = Toggle shuffle (<b><u>r</u></b>andom)</td></tr>
						<tr><td>SHIFT + s</td><td> = Download all the files in the list as a zip archive</td></tr>
					</table>

					<h3>Credits</h3>
					All server side code written by
					<a target="_blank" href="https://fornaxian.com/">Fornax (me)</a>.
					<br/>
					<br/>
					Code syntax highlighting is by
					<a target="_blank" href="https://github.com/google/code-prettify">Google Code-prettify</a>.
					<br/>
					<br/>
					Thanks to the Mozilla team for their wonderful PDF viewer
					<a target="_blank" href="https://github.com/mozilla/pdf.js">pdf.js</a>.
					<br/>
				</span>
			</div>
		</div>
		<div id="captcha_popup" class="popup captcha_popup">
			<div id="captcha_popup_title" class="highlight_headerbar"></div>
			<div id="captcha_popup_content" class="content_area"></div>
			<br/>
			<div id="captcha_popup_captcha" style="text-align: center;"></div>
		</div>

		<script src="/res/misc/chartjs/Chart.min.js"></script>
		<script src="/res/script/jquery.js"></script>
		<script src="/res/script/Keyboard.js"></script>
		<script src="/res/script/Toolbar.js?v2"></script>
		<script src="/res/script/Viewer.js?v2"></script>
		<script src="/res/script/ListNavigator.js?v2"></script>

		<script>
			// This info gets filled in on the server side to prevent having to make an API call right after the page loads.
			// Just to slice another few milliseconds from the load time :)
			Viewer.init('{{.Other.Type}}', {{.Other.APIResponse}});
		</script>

		{{template "analytics"}}
	</body>
</html>
{{end}}
