{{define "file_viewer"}}
<!DOCTYPE html>
<html>
	<head>
		<title>{{.Title}}</title>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		{{template "user_style" .}}
		<link rel="stylesheet" href="/res/style/viewer.css?v2"/>
		<link rel="stylesheet" href="/res/style/layout.css?v2"/>
		<link rel="shortcut icon" href="/res/img/tray32.png"/>
		<link rel="icon" sizes="180x180" href="/res/img/pixeldrain.png"/>
		<link rel="icon" sizes="256x256" href="/res/img/pixeldrain_big.png"/>
		<meta name="theme-color" content="#75AD38"/>

		<!-- <link rel="alternate" type="application/json+oembed" th:href="*{oEmbedHref}" th:title="*{ogTitle}" /> OEmbed will return soon -->

		{{template "bgpattern"}}

		{{.OGData}}

		<script type="text/javascript">
			var apiEndpoint = '{{.APIEndpoint}}';
			var captchaKey = '{{.Other.CaptchaKey}}';
		</script>
	</head>

	<body>
		<div id="listNavigator">
			<div id="listNavigatorItems"></div>
			<div id="arrow-left" alt="Previous Item" onClick="ListNavigator.previousItem();"></div>
			<div id="arrow-right" alt="Next Item" onClick="ListNavigator.nextItem();"></div>
		</div>
		<button id="button-expand-toolbar" onClick="Toolbar.toggle();">Show Toolbar</button>
		<div id="toolbar">
			<!-- Ugly workaround to get rid of the scrollbar in non-webkit browsers -->
			<div>
				<div>
					<button class="toolbar_button button_full_width" onClick="Toolbar.toggle();">Hide Toolbar</button>

					<div id="stat_views_label" class="toolbar_label">Views</div>
					<div id="stat_views" style="text-align: center;">N/A</div>
					<div id="stat_downloads_label" class="toolbar_label">Downloads</div>
					<div id="stat_downloads" style="text-align: center;">N/A</div>

					<a href="/" id="btnHome" class="toolbar_button button_full_width button">
						<img src="/res/img/pixeldrain_small.png" alt="Back to the Home page"/>
						<span>Home</span>
					</a>
					<button id="btnDownload" class="toolbar_button button_full_width" onClick="Toolbar.download();">
						<img src="/res/img/floppy_small.png" alt="Download this file"/>
						<span>Download</span>
					</button>
					<button id="btnCopy" class="toolbar_button button_full_width" onClick="Toolbar.copyUrl();">
						<img src="/res/img/clipboard_small.png" alt="Copy file URL to clipboard"/>
						<span>Copy</span>
					</button>
					<button id="btnShare" class="toolbar_button button_full_width" onClick="Sharebar.toggle();">
						<img src="/res/img/share_small.png" alt="Share this file on social media"/>
						<span>Share</span>
					</button>
					<button id="btnDetails" class="toolbar_button button_full_width" onClick="DetailsWindow.toggle();">
						<img src="/res/img/info_small.png" alt="Help"/>
						<span>Details</span>
					</button>
					{{template "advertisement" .}}

					<!-- This frame will load the download URL when a download button is pressed -->
					<iframe id="download_frame" style="display: none; width: 1px; height: 1px;"></iframe>
				</div>
			</div>
		</div>

		<div id="sharebar" class="sidebar">
			Share on:<br/>
			<button class="sharebar-button button_full_width" onclick="window.open('https://www.reddit.com/submit?url=' + window.location.href);">
				<img src="/res/img/social_reddit.png" alt="Share on Reddit" style="width:40px; height: 40px;"/>
				<br/>Reddit
			</button>
			<button class="sharebar-button button_full_width" onClick="window.open('https://voat.co/submit?linkpost=true&url=' + window.location.href);">
				<img src="/res/img/social_voat.png" alt="Share on Voat" style="width:40px; height: 40px;"/>
				<br/>Voat
			</button>
			<button class="sharebar-button button_full_width" onClick="window.open('http://www.facebook.com/sharer.php?u=' + window.location.href);">
				<img src="/res/img/social_facebook.png" alt="Share on Facebook" style="width:40px; height: 40px;"/>
				<br/>Facebook
			</button>
			<button class="sharebar-button button_full_width" onClick="window.open('https://twitter.com/share?text=Check%20out%20this%20file%20on%20%23Pixeldrain&url=' + window.location.href);">
				<img src="/res/img/social_twitter.png" alt="Share on Twitter" style="width:40px; height: 40px;"/>
				<br/>Twitter
			</button>
			<button class="sharebar-button button_full_width" onClick="window.open('https://plus.google.com/share?url=' + window.location.href);">
				<img src="/res/img/social_googleplus.png" alt="Share on Google Plus" style="width:40px; height: 40px;"/>
				<br/>Google+
			</button>
			<button class="sharebar-button button_full_width" onClick="window.open('http://www.tumblr.com/share/link?url=' + window.location.href);">
				<img src="/res/img/social_tumblr.png" alt="Share on Tumblr" style="width:40px; height: 40px;"/>
				<br/>Tumblr
			</button>
			<button class="sharebar-button button_full_width" onClick="window.open('http://www.stumbleupon.com/submit?url=' + window.location.href);">
				<img src="/res/img/social_stumbleupon.png" alt="Share on StumbleUpon" style="width:40px; height: 40px;"/>
				<br/>StumbleUpon
			</button>
			<button class="sharebar-button button_full_width" onClick="window.open('mailto:please@set.address?subject=File%20on%20PixelDrain&body=You%20can%20view%20it%20here%20' + window.location.href);">
				<img src="/res/img/social_email.png" alt="Share on E-Mail" style="width:40px; height: 40px;"/>
				<br/>E-Mail
			</button>
		</div>

		<div id="details_popup" class="popup details_popup border_bottom">
			<div id="details_popup_title" class="highlight_light border_top border_bottom">
				File Info
				<button style="position: absolute; top: 3px; right: 3px;" class="button_red" onclick="DetailsWindow.toggle();">X</button>
			</div>
			<span id="info_file_details"></span>
			<span id="info_about">
				<h3>About</h3>
				Pixeldrain is a file sharing platform.
				<a href="/" target="_blank">Visit the home page for more information.</a>

				<h3>Keyboard Controls</h3>
				<table>
					<tr><td colspan="2">File Shortcuts</td></tr>
					<tr><td>c</td><td> = Copy URL of this page</td></tr>
					<tr><td>i</td><td> = Toggle details window (this window)</td></tr>
					<tr><td>s</td><td> = Download the file you are currently viewing</td></tr>
					<tr><td colspan="2">List Shortcuts</td></tr>
					<tr><td>a or &#8592;</td><td> = View previous item in list</td></tr>
					<tr><td>d or &#8594;</td><td> = View next item in list</td></tr>
					<tr><td>r</td><td> = Toggle shuffle (<b><u>r</u></b>andom)</td></tr>
					<tr><td>SHIFT + s</td><td> = Download all the files in the list as a zip archive</td></tr>
				</table>

				<h3>Credits</h3>
				All server side code written by
				<a target="_blank" href="https://fornaxian.com/">Fornax (me)</a>.
				<br/>
				<br/>
				Code syntax highlighting is by
				<a target="_blank" href="https://github.com/google/code-prettify">Google Code-prettify</a>.
				<br/>
				<br/>
				Thanks to the Mozilla team for their wonderful PDF viewer
				<a target="_blank" href="https://github.com/mozilla/pdf.js">pdf.js</a>.
				<br/>
			</span>
		</div>
		<div id="captcha_popup" class="popup captcha_popup border_bottom">
			<div id="captcha_popup_title" class="highlight_light border_top border_bottom"></div>
			<div id="captcha_popup_content"></div>
			<br/>
			<div id="captcha_popup_captcha" style="text-align: center;"></div>
		</div>

		<div id="filepreview">
			<img src="/res/img/misc/loadthink.gif" style="margin-top: 20%; width: 200px; height: 200px;" />
		</div>

		<script src="/res/script/jquery.js"></script>
		<script src="/res/script/Keyboard.js"></script>
		<script src="/res/script/Toolbar.js?v1"></script>
		<script src="/res/script/Viewer.js?v1"></script>
		<script src="/res/script/ListNavigator.js"></script>

		<script>
			// This info gets filled in on the server side to prevent having to make an API call right after the page loads.
			// Just to slice another few milliseconds from the load time :)
			Viewer.init('{{.Other.Type}}', {{.Other.APIResponse}});
		</script>

		{{template "analytics"}}
	</body>
</html>
{{end}}
