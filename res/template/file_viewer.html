{{define "file_viewer"}}
<!DOCTYPE html>
<html lang="en">
	<head>
		<title>{{.Title}}</title>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		{{template "user_style" .}}
		<link rel="shortcut icon" href="/res/img/tray32.png"/>
		<link rel="icon" sizes="180x180" href="/res/img/pixeldrain.png"/>
		<link rel="icon" sizes="256x256" href="/res/img/pixeldrain_big.png"/>
		<meta name="theme-color" content="#75AD38"/>

		<style>
		{{template `viewer.css`}}
		{{template `layout.css`}}
		</style>

		{{.OGData}}
	</head>

	<body>
		<div id="file_viewer" class="file_viewer">
			<div id="file_viewer_headerbar" class="highlight_1 file_viewer_headerbar">
				<button id="button_toggle_toolbar" class="button_toggle_toolbar" onClick="Toolbar.toggle();">â˜°</button>
				<a href="/" id="button_home" class="button button_home">
					<img src="{{template `pixeldrain_icon.png`}}"
						alt="Back to the Home page"
						style="height: 1.5em; margin: -0.2em; margin-right: 0.2em;"/>
				</a>
				<div id="file_viewer_headerbar_title" class="file_viewer_headerbar_title">
					<div id="file_viewer_list_title"></div>
					<div id="file_viewer_file_title">{{.Title}}</div>
				</div>
				<button id="button_close_file_viewer" class="button_close_file_viewer button_red" onClick="window.close();">{{template `close.svg` .}}</button>
			</div>
			<div id="list_navigator" class="list_navigator"></div>
			<div id="file_viewer_window" class="file_viewer_window">
				<div id="toolbar" class="file_viewer_toolbar"><div><div>
					<div id="stat_views_label" class="toolbar_label">Views</div>
					<div id="stat_views" style="text-align: center;">N/A</div>
					<div id="stat_downloads_label" class="toolbar_label">Downloads</div>
					<div id="stat_downloads" style="text-align: center;">N/A</div>

					<button id="btnDownload" class="toolbar_button button_full_width" onClick="Toolbar.download();">
						{{template `save.svg` .}}
						<span>Download</span>
					</button>
					<button id="btnDownloadList" class="toolbar_button button_full_width" style="display: none" onClick="Toolbar.downloadList()">
						{{template `save.svg` .}}
						<span>DL all files</span>
					</button>
					<button id="btnCopy" class="toolbar_button button_full_width" onClick="Toolbar.copyUrl();">
						{{template `copy.svg` .}}
						<span><u>C</u>opy Link</span>
					</button>
					<button id="btnShare" class="toolbar_button button_full_width" onClick="Sharebar.toggle();">
						{{template `share.svg` .}}
						<span>Share</span>
					</button>
					<button id="btnShuffle" class="toolbar_button button_full_width" style="display: none" onClick="ListNavigator.toggleShuffle();">
						{{template `shuffle.svg` .}}
						<span>Shuffle &#x2610;</span>
					</button>
					<button id="btnDetails" class="toolbar_button button_full_width" onClick="DetailsWindow.toggle();">
						{{template `help.svg` .}}
						<span>Deta<u>i</u>ls</span>
					</button>
					{{template "advertisement" .}}

					<!-- This frame will load the download URL when a download button is pressed -->
					<iframe id="download_frame" style="display: none; width: 1px; height: 1px;"></iframe>
				</div></div></div>

				<div id="sharebar" class="file_viewer_sharebar">
					Share on:<br/>
					<button class="sharebar-button button_full_width" onclick="window.open('mailto:please@set.address?subject=File%20on%20pixeldrain&body=' + window.location.href);">
						{{template `email.svg` .}}<br/>E-Mail
					</button>
					<button class="sharebar-button button_full_width" onclick="window.open('https://www.reddit.com/submit?url=' + window.location.href);">
						{{template `reddit.svg` .}}<br/>Reddit
					</button>
					<button class="sharebar-button button_full_width" onclick="window.open('https://twitter.com/share?url=' + window.location.href);">
						{{template `twitter.svg` .}}<br/>Twitter
					</button>
					<button class="sharebar-button button_full_width" onclick="window.open('http://www.facebook.com/sharer.php?u=' + window.location.href);">
						{{template `facebook.svg` .}}<br/>Facebook
					</button>
					<button class="sharebar-button button_full_width" onclick="window.open('http://www.tumblr.com/share/link?url=' + window.location.href);">
						{{template `tumblr.svg` .}}<br/>Tumblr
					</button>
				</div>

				<div id="filepreview" class="file_viewer_file_preview">
					<div class="image" style="margin-top: 20%; width: 100px; height: 100px;">{{template "spinner.svg" .}}</div>
				</div>
			</div>
			<div id="sponsors" class="sponsors">
				<!-- scrolling="no" is not allowed by the W3C, but overflow: hidden doesn't work in chrome, so I have no choice -->
				<iframe
					data-aa="73974"
					src="//ad.a-ads.com/73974?size=728x90&background_color={{.Style.Layer1Color.RGB}}&text_color={{.Style.TextColor.RGB}}&title_color={{.Style.HighlightColor.RGB}}&title_hover_color={{.Style.HighlightColor.RGB}}&link_color={{.Style.HighlightColor.RGB}}&link_hover_color={{.Style.HighlightColor.RGB}}"
					style="width:728px; height:90px; border:none; padding:0; overflow:hidden;"
					scrolling="no">
				</iframe>
			</div>
		</div>

		<div id="details_popup" class="popup details_popup">
			<div id="details_popup_title" class="highlight_1">
				File Info
				<button style="position: absolute; top: 3px; right: 3px;" class="button_red" onclick="DetailsWindow.toggle();">{{template `close.svg` .}}</button>
			</div>
			<div class="content_area">
				<div id="info_file_details"></div>
				<div id="info_about">
					<h3>Downloads and views</h3>
					<div id="chart_container" class="chart-container" style="position: relative; width: 100%; height: auto;">
						<canvas id="bandwidth_chart"></canvas>
					</div>
					<p style="text-align: center">
						Chart rendered by the amazing <a href="https://www.chartjs.org/" target="_blank">Chart.js</a>.
					</p>

					<h3>About</h3>
					Pixeldrain is a file sharing platform.
					<a href="/" target="_blank">Visit the home page for more information.</a>

					<h3>Keyboard Controls</h3>
					<table>
						<tr><td colspan="2">File Shortcuts</td></tr>
						<tr><td>c</td><td> = Copy URL of this page</td></tr>
						<tr><td>i</td><td> = Toggle details window (this window) (<b><u>i</u></b>nfo)</td></tr>
						<tr><td>s</td><td> = Download the file you are currently viewing (<b><u>s</u></b>ave)</td></tr>
						<tr><td>q</td><td> = Close the window (<b><u>q</u></b>uit)</td></tr>
						<tr><td colspan="2">List Shortcuts</td></tr>
						<tr><td>a or &#8592;</td><td> = View previous item in list</td></tr>
						<tr><td>d or &#8594;</td><td> = View next item in list</td></tr>
						<tr><td>r</td><td> = Toggle shuffle (<b><u>r</u></b>andom)</td></tr>
						<tr><td>SHIFT + s</td><td> = Download all the files in the list as a zip archive</td></tr>
					</table>
				</div>
			</div>
		</div>
		<div id="captcha_popup" class="popup captcha_popup">
			<div id="captcha_popup_title" class="highlight_headerbar"></div>
			<div id="captcha_popup_content" class="content_area"></div>
			<br/>
			<div id="captcha_popup_captcha" style="text-align: center;"></div>
		</div>

		<script src="/res/script/Chart.min.js"></script>
		<script src="/res/script/jquery.js"></script>
		<script>
			var apiEndpoint = '{{.APIEndpoint}}';
			var captchaKey = '{{.Other.CaptchaKey}}';

			{{template `Toolbar.js`}}
			{{template `Viewer.js`}}
			{{template `ListNavigator.js`}}

			// This info gets filled in on the server side to prevent having to make an API call right after the page loads.
			// Just to slice another few milliseconds from the load time :)
			window.addEventListener("load", function(){
				Viewer.init('{{.Other.Type}}', {{.Other.APIResponse}});
			});
		</script>

		{{template "analytics"}}
	</body>
</html>
{{end}}
